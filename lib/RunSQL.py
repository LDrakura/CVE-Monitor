import sqlite3
import lib.MyLog as MyLog
import os

def run(sql):
    MyLog.log(sql)
    syspath = os.path.dirname(os.path.abspath(__file__))
    monitorDB = sqlite3.connect(syspath+"/../db/monitor.db")
    conn = monitorDB.cursor()
    conn.execute(sql)
    monitorDB.commit()
    result = conn.fetchall()
    monitorDB.close()
    return result



def insertValue(cve_name,git_name,git_url,git_des,readme_hash,status):
    sql = "INSERT INTO main.monitor('cve','gitname','giturl','description','hash','status') VALUES('%s','%s','%s','%s','%s','%s')"%(cve_name,git_name,git_url,filter(git_des),readme_hash,status)
    run(sql)




def filter(keyWord):
    keyWord = keyWord.replace("/*", "")
    keyWord = keyWord.replace("*/", "")
    keyWord = keyWord.replace("'", "")
    keyWord = keyWord.replace("\"", "")
    keyWord = keyWord.replace("--", "")
    return keyWord

